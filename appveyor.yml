before_build:
  - cmd: appveyor-retry nuget restore
  - sh: nuget restore

version: "{build}"
clone_depth: 250

build:
  parallel: true
  project: Radio Downloader.sln

image:
  - Visual Studio 2015
  - Ubuntu

platform:
  - win32
  - win64
  - mono

configuration: Package

matrix:
  exclude:
    - image: Visual Studio 2015
      platform: mono
    - image: Ubuntu
      platform: win32
    - image: Ubuntu
      platform: win64

for:
  - matrix:
      only:
        - image: Ubuntu
        - platform: mono
    build_script:
      - msbuild "Radio Downloader.sln"
    test_script:
      - packages/xunit.runners.1.9.2/tools/xunit.console.exe "bin/mono/Radio Downloader Test.dll"
      - packages/xunit.runners.1.9.2/tools/xunit.console.exe "bin/mono/PodcastProvider Test.dll"

artifacts:
  - path: installer/Radio_Downloader-win*.msi
